# Abschlussaufgabe

Herzlichen Gl√ºckwunsch, Sie haben es fast durch Programmierung 1 geschafft - hier kommt die Abschlussaufgabe!

## Abgabe

Sie k√∂nnen die L√∂sung auf drei Arten abgeben:

- Falls Sie schon Erfahrung mit git haben, k√∂nnen Sie das Repository forken, den fork auf private schalten, Ihre L√∂sung dort verwalten und mich zu dem repo einladen. Die Antwort auf die Analyse-Frage am Ende tragen Sie in diesem Fall bitte einfach am Ende der README.md ein. Ich werde dann f√ºr die Benotung den letzten commit mit Datum vor dem Ende des 1. Pr√ºfungszeitraums verwenden.
- Sie k√∂nnen auch den *kompletten* src-Ordner packen (zip, tar, tar.gz - was Ihnen am liebsten ist) und mir vor Ende des 1. Pr√ºfungszeitraums abgeben, indem Sie:
  - Die Datei in Moodle als Abgabe hochladen. Tragen Sie in diesem Fall Ihre Antwort auf die Analyse-Frage in das Freitextfeld der Abgabe ein.
  - Mir die Datei per Mail *von Ihrem HTW-Mail-Account aus* schicken, in dem Text der Mail soll dann die Antwort auf die Analyse-Frage stehen. Bitte nutzen Sie diese M√∂glichkeit nur als Backup f√ºr den Fall, dass aus irgendeinem Grund die Abgabe per Moodle bei Ihnen nicht funktioniert!

*VORSICHT* Das ist eine Pr√ºfungsaufgabe, bei der es einige klare Regeln gibt, von denen ich nicht abweichen werde. Die Pr√ºfung gilt auf *jeden Fall* als *nicht bestanden*, falls:
- Sie die Aufgabe auf eine andere Art abgeben, als die 3 oben genannten M√∂glichkeiten (dazu z√§hlt auch, wenn Sie mir beispielsweise den Code einfach in die Mail copy-pasten - das w√ºrde als "nicht korrekt abgegeben, nicht bestanden" gelten)
- Die Tests nicht funktionieren. Es geht wie in fast jeder √úbung besprochen nicht darum, dass alle Tests "gr√ºn" sein m√ºssen, aber der Gradle-Task "verification->test" muss grundlegend funktionieren, die Tests m√ºssen alle ausgef√ºhrt werden (egal, ob das Ergebnis "passed" oder "failed" ist, das hat dann nur auf die Zensur Einfluss)
- Sie die Testdateien im Verzeichnis src/test ver√§ndert haben

## Benotung

F√ºr jede korrekt implementierte Methode gibt es pauschal 4.5 Punkte. Es sind insgesamt 21 Methoden zu implementieren, somit k√∂nnen mit einer vollst√§ndig korrekten Implementation 94.5 Punkte erreicht werden.

F√ºr die Analyseaufgabe gibt es 6.5 Punkte.

Insgesamt k√∂nnen somit maximal 100 Punkte erreicht werden, die Umrechnung in eine Zensur erfolgt entsprechend der hochschul√ºblichen Skala.

## Hintergrund

In dieser Aufgabe arbeiten Sie mit Daten aus dem [OpenData-Portal des Deutschen Wetterdienstes](https://www.dwd.de/DE/leistungen/opendata/opendata.html), um zu sehen, wie sich mit der Zeit die Temperaturen an diversen Messstationen ver√§ndert haben.

Sie k√∂nnen die historischen Temperaturdaten der letzten Jahre [hier](https://opendata.dwd.de/climate_environment/CDC/observations_germany/climate/daily/kl/historical/) als zip-Dateien herunterladen.
Auf den Seiten des DWD finden Sie auch eine [Beschreibung des Formats der Datendateien](https://opendata.dwd.de/climate_environment/CDC/observations_germany/climate/daily/kl/BESCHREIBUNG_obsgermany-climate-daily-kl_de.pdf) sowie eine [Liste der Stationsnummern](https://opendata.dwd.de/climate_environment/CDC/observations_germany/climate/daily/kl/historical/KL_Tageswerte_Beschreibung_Stationen.txt). Zum Testen k√∂nnen Sie auch die Datei "testdata.txt" aus dem data-Ordner in diesem Repository verwenden.

Endziel dieser Aufgabe ist es, dass Sie aus der Datendatei die Mindest-, Maximal- sowie Durchschnittstemperaturen lesen und zwischen zwei Jahren einen Vergleich erstellen.



## TemperatureDataPoint

Implementieren Sie eine Klasse `TemperatureDataPoint`, die einen Temperaturdatenpunkt (repr√§sentiert durch eine Zeile in der Datendatei) mit den folgenden Informationen h√§lt:

- Jahr, in dem der Datenpunkt aufgenommen wurde (aus MESS_DATUM)
- Minimaltemperatur an dem Tag (TNK)
- Maximaltemperatur an dem Tag (TXK)
- Durchschnittstemperatur an dem Tag (TMK)

Die Klasse soll folgende Funktionalit√§ten bieten:

### Konstruktoren und Grundfunktionen

* `public TemperatureDataPoint(double min, double avg, double max, int year)`: Constructor, der die 4 Werte des Datenpunktes explizit √ºbergeben bekommt.
* `public TemperatureDataPoint(String line)`: Constructor, der eine Zeile aus der Textdatei bekommt. Zur Erinnerung: In dem vorherigen Abschnitt ist eine Beschreibung des Dateiformats verlinkt, in der steht, wo in jeder Zeile die n√∂tigen Werte (MESS_DATUM, TNK, TXK, TMK) zu finden sind. Sie k√∂nnen auch zur Sicherheit in den Code der Tests schauen.
* `public double getMinTemperature()`: Gibt die Minimaltemperatur an dem Tag zur√ºck.
* `public double getAvgTemperature()`: Gibt die Durchschnittstemperatur an dem Tag zur√ºck.
* `public double getMaxTemperature()`: Gibt die Maximaltemperatur an dem Tag zur√ºck.
* `public int getYear()`: Gibt das Jahr, in dem der Datenpunkt aufgenommen wurde, zur√ºck.

### Analysemethoden

* `public double[] getTemperatures()`: Gibt die Temperaturen als double-Array zur√ºck. Dabei soll an Position 0 die Mindesttemperatur, an Position 1 die Durchschnittstemperatur und an Position 2 die Maximaltemperatur stehen. Vorsicht: Die Reihenfolge ist hier anders, als in der Datei!
* `public TemperatureDataPoint getTemperatureDifference(TemperatureDataPoint other)`: Gibt einen neuen `TemperatureDataPoint` zur√ºck, der die Absolutwerte der Differenzen der Temperaturen von diesem `TemperatureDataPoint` und `other` zur√ºckgibt. Das Jahr soll dem Jahr des `TemperatureDataPoint` entsprechen, auf dem die Methode aufgerufen wurde (also nicht dem Jahr von `other`, falls die Jahre unterschiedlich sind).
* `public boolean isInYear(int year)`: Gibt `true` zur√ºck, falls das Mess-Datum des Punktes im √ºbergebenen Jahr liegt, sonst `false`.

### Ausgabe

* `public String toString()`: Gibt eine String-Repr√§sentation des Datenpunktes zur√ºck, nach dem folgenden Format:
  "Temperatures on given day in [Jahr]: [Minimaltemperatur] - [Maximaltemperatur], average: [Durchschnittstemperatur].". Die Ausgabe w√§re also f√ºr das Jahr 2023 mit TNK=5.0, TXK=7.5 und TMK=5.5: "Temperatures on given day in 2023: 5.0 - 7.5, average: 5.5.".

### Hinweise

* Achten Sie darauf, dass die Methode `toString()` einen String zur√ºckgeben soll, ein reines Ausgeben reicht nicht!


## TemperatureTimeSeries

Implementieren Sie eine Klasse `TemperatureTimeSeries`, die eine Zeitreihe von Temperaturdaten verwaltet. Die Klasse soll folgende Funktionalit√§ten bieten:

### Konstruktoren und Grundfunktionen

* `public TemperatureTimeSeries()`: Erstellt eine leere Zeitreihe.
* `public TemperatureTimeSeries(String filename)`: Liest Temperaturdaten aus einer CSV-Datei ein. Das Format der einzelnen Zeilen ist wie in `public TemperatureDataPoint(String line)` beschrieben. Die erste Zeile wird als Header √ºbersprungen.
* `public void addDataPoint(TemperatureDataPoint dataPoint)`: F√ºgt einen einzelnen Datenpunkt zur Zeitreihe hinzu.
* `public ArrayList<TemperatureDataPoint> getDataPoints()`: Gibt alle Datenpunkte zur√ºck.
* `public int getNumDatapoints()`: Gibt die Anzahl der Datenpunkte zur√ºck.

### Analysemethoden

* `public TemperatureTimeSeries filterByYear(int year)`: Erstellt eine neue Zeitreihe, die nur Datenpunkte aus dem angegebenen Jahr enth√§lt. Es soll also eine neue `TemperatureTimeSeries` erstellt werden, die aber nur die `TemperatureDataPoint`s enth√§lt, welche in dem Jahr `year` aufgenommen wurden.
* `public double getMinTemperature()`: Ermittelt die niedrigste Temperatur √ºber alle Datenpunkte.
* `public double getMaxTemperature()`: Ermittelt die h√∂chste Temperatur √ºber alle Datenpunkte.
* `public double getOverallAvg()`: Berechnet den Durchschnitt der Durchschnittstemperaturen aller Datenpunkte.
* `public TemperatureDataPoint[] getTemperatureDifferences()`: Berechnet die absoluten Temperaturdifferenzen zwischen aufeinanderfolgenden Datenpunkten und gibt diese als Array zur√ºck. Hinweis: Sie k√∂nnen hier eine der Analysemethoden von `TemperatureDataPoint` verwenden, um sich das Leben sehr einfach zu machen.

### Ausgabe

* `public String toString()`: Gibt eine formatierte √úbersicht der Zeitreihe zur√ºck. Das Format soll wie folgt aussehen, wobei [Datenpunkt n] jeweils die Beschreibung ist, die der entsprechende `TemperatureDataPoint` mit seiner `toString()`-Methode zur√ºckgibt:
  ```
  Temperature time series with [Anzahl] data points:
  * [Datenpunkt 1]
  * [Datenpunkt 2]
  ...
  ```

### Fehlerbehandlung

* Der Konstruktor mit Dateinamen soll eine Exception mit der Nachricht "Fehler beim Einlesen der Datei [Dateiname]" werfen, falls die Datei nicht gelesen werden kann.

### Hinweise

* Die Klasse arbeitet mit der bereits implementierten Klasse `TemperatureDataPoint` zusammen.
* Bei der Berechnung von Durchschnittswerten und Temperaturunterschieden m√ºssen keine leeren Zeitreihen ber√ºcksichtigt werden.
* Die Datenpunkte sollen in `toString()` in der Reihenfolge aufgelistet werden, in der sie eingelesen oder hinzugef√ºgt wurden.

## Analyseaufgabe

Implementieren Sie eine Klasse `Main` mit der gewohnten `main`-Methode, um den Code als eigenst√§ndiges Programm auszuf√ºhren. F√ºhren Sie das Programm mit einer Datei von der DWD-Webseite f√ºr eine Station Ihrer Wahl aus. Filtern Sie datai mit der Methode `filterByYear()` zwei Jahre Ihrer Wahl heraus, die mindestens 10 Jahre auseinanderliegen. Lassen Sie sich dann f√ºr diese beiden Jahre jeweils die Gesamt-Durchschnittstemperatur (berechnet √ºber die Methode `getOverallAvg()`) ausgeben und geben Sie die Ergebnisse (Stationsname, die 2 Jahreszahlen sowie die entsprechenden Temperaturen) als Antwort als die Analyseaufgabe an. Beschreiben Sie zudem kurz die Ergebnisse. 

F√§llt Ihnen etwas Seltsames auf? Falls ja, woran k√∂nnte das liegen? K√∂nnen Sie das Problem beheben, und wie √§ndert sich danach das Ergebnis (f√ºr die letzten 2 Fragen gibt es keine Punkte, es ist rein freiwillig)?

üìä Analyse und Beobachtungen
Ich habe die Aufgabe schrittweise umgesetzt und die Durchschnittstemperaturen f√ºr zwei Jahre (1937 und 1950) an derselben Station (Siegen) berechnet und auf der Konsole ausgegeben. Dabei fiel mir auf, dass in beiden F√§llen die berechnete Durchschnittstemperatur -999‚ÄØ¬∞C betrug ‚Äì ein offensichtlich fehlerhafter Wert.

Nach genauerem Hinsehen stellte ich fest, dass fehlende Temperaturdaten in der CSV-Datei vom DWD mit dem Wert -999 gekennzeichnet sind. Diese Werte wurden bei der Berechnung des Durchschnitts mit einbezogen, was zu stark verf√§lschten Durchschnittstemperaturen f√ºhrte. Temperaturen von -999‚ÄØ¬∞C sind physikalisch unm√∂glich und deuten auf fehlende oder ung√ºltige Daten hin.

Zun√§chst habe ich alle -999-Werte durch 0 ersetzt, um sie als ung√ºltig zu markieren. Doch auch das f√ºhrte zu Problemen: Die Durchschnittstemperaturen wurden nun als 0‚ÄØ¬∞C berechnet ‚Äì was erneut nicht der Realit√§t entsprach. Dadurch wurde mir klar, dass ung√ºltige oder fehlende Werte weder als 0 noch als -999 in die Berechnung einflie√üen d√ºrfen.

Letztlich habe ich mein Programm so angepasst, dass alle ung√ºltigen Werte als NaN (Not a Number) markiert werden. Beim Berechnen der Durchschnittstemperatur werden diese Werte ignoriert ‚Äì sie z√§hlen weder zum Summenwert noch zur Z√§hleranzahl (g√ºltiger Tage). Dadurch konnte ich auf Basis der tats√§chlich vorhandenen, g√ºltigen Messwerte eine realistischere Durchschnittstemperatur berechnen.

Trotzdem ist mir bewusst: Wenn f√ºr viele Tage eines Jahres keine Daten vorliegen, ist die Aussagekraft des Durchschnittswerts eingeschr√§nkt. Denn wir wissen nicht, wie warm oder kalt es an den fehlenden Tagen war.

Weitere Auff√§lligkeiten bei der Analyse
Nach der Korrektur habe ich die Analyse ausgeweitet und f√ºr zwei verschiedene Stationen vier Jahre miteinander verglichen: 1937, 1950, 1986 und 2024.

Die Stationen waren:

Siegen (Kl√§ranlage)

Tann/R√∂hn

**Die CSV-Datei von Siegen enth√§lt keine Daten f√ºr 2024, daher erscheint dort NaN als Durchschnittstemperatur.

**Die CSV-Datei von Tann/R√∂hn enth√§lt keine Daten f√ºr 1937 und 1950, daher ist auch hier der Durchschnitt NaN f√ºr diese Jahre.

üìü Konsolenausgabe:
Analyse fuer DWD-Daten:

Station: Siegen (Klaeranlage)
Jahr 1937: Durchschnittstemperatur = 8,58 ¬∞C
Jahr 1950: Durchschnittstemperatur = 8,60 ¬∞C
Jahr 1986: Durchschnittstemperatur = 8,44 ¬∞C
Jahr 2024: Durchschnittstemperatur = NaN ¬∞C

Station: Tann/Roehn
Jahr 1937: Durchschnittstemperatur = NaN ¬∞C
Jahr 1950: Durchschnittstemperatur = NaN ¬∞C
Jahr 1986: Durchschnittstemperatur = 7,52 ¬∞C
Jahr 2024: Durchschnittstemperatur = 10,41 ¬∞C
